<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
    xmlns:sec="http://www,thymeleaf.org/thymeleaf-extras-springsecurity6">
    <head th:fragment="htmlHead(title, cssPath)">
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title th:text="${title}"></title>       
        <!-- Ìè∞Ìä∏ preload -->
		<link rel="preload" as="font" type="font/woff2" th:href="@{/fonts/SpoqaHanSansNeo-Bold.woff2}" crossorigin="anonymous">
		<link rel="preload" as="font" type="font/woff2" th:href="@{/fonts/SpoqaHanSansNeo-Regular.woff2}" crossorigin="anonymous">

        <!-- Bootstrap CSS -->
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" 
              rel="stylesheet">
        <!-- Í∞Å ÌéòÏù¥ÏßÄÏóêÏÑú Ï∂îÍ∞ÄÌï† CSS (ÏûàÏúºÎ©¥ Î°úÎìú) -->
        <link rel="stylesheet" th:if="${cssPath != null}" th:href="@{${cssPath}}">
    </head>
    	
        <body>
            <th:block th:fragment="pageHeader">
        <header>
            <nav class="navbar navbar-expand-sm bg-body-tertiary w-100 header-top">
                <div class="container-fluid container-head">
                    <a class="navbar-brand" th:href="@{/}">
                    <img th:src="@{/images/logo5.PNG}" alt="ÎπåÎ¶¨Í≥†Î°úÍ≥†" width="150">
                    </a>
                    
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarTopNav">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <form th:action="@{/search}" method="get" class="search-box">
                    <label for="search-input" style="cursor: pointer; width: 100%;">
                        <input type="text" id="search-input" name="search" placeholder="ÏäàÌçºÏπ¥Î•º Îã®Îèà ÎßåÏõêÏóê?!" readonly onclick="this.form.submit()">
                    </label>
                    <button type="submit" class="headsearch-icon"></button>
                </form>

                <!-- ‚úÖ ÎÑ§ÎπÑÍ≤åÏù¥ÏÖò Î©îÎâ¥ (Í∏∞Î≥∏ Î∞è Î™®Î∞îÏùº) -->
                <div class="collapse navbar-collapse justify-content-end" id="navbarTopNav">
                    <ul class="navbar-nav">
					    <!-- Í≥µÌÜµ Î©îÎâ¥ -->
					    <li class="nav-item"><a class="nav-link" th:href="@{/chat}">CHAT</a></li>
					    <li class="nav-item"><a class="nav-link" th:href="@{/jjam/shop}">JJAM</a></li>
					
					    <!-- Î°úÍ∑∏Ïù∏ ÏÉÅÌÉúÎ≥Ñ Î∂ÑÍ∏∞ -->
					    <th:block sec:authorize="isAnonymous()">
					        <li class="nav-item"><a class="nav-link" th:href="@{/member/signin}">LOGIN</a></li>
					        <li class="nav-item"><a class="nav-link" th:href="@{/member/signup}">JOIN</a></li>
					    </th:block>
					
					    <th:block sec:authorize="isAuthenticated()">
					        <li class="nav-item position-relative mypage-container">
						    <button class="nav-link btn btn-link mypage-btn">MY</button>
						    <div class="mypage-popup">
						      <a class="nav-link pop-nav-link" th:href="@{/mypage}">
						        <span class="emoji">ü•∞</span> ÎßàÏù¥ÌéòÏù¥ÏßÄ
						      </a>
						      <a class="nav-link pop-nav-link" th:href="@{/member/modify}">
						        <span class="emoji">üõ†Ô∏è</span> Ï†ïÎ≥¥ÏàòÏ†ï
						      </a>
						      <a class="nav-link pop-nav-link" th:href="@{/logout}">
						        <span class="emoji">üîì</span> Î°úÍ∑∏ÏïÑÏõÉ
						      </a>
						    </div>
						  </li>
					    </th:block>
					
					    <!-- Ìï≠ÏÉÅ Ïò§Î•∏Ï™ΩÏóê Í≥†Ï†ïÎê† ÏïåÎûå Î©îÎâ¥ -->
					  <li class="nav-item position-relative alarm-container">
  						  <a class="nav-link alarm-btn" href="javascript:void(0)" sec:authorize="isAuthenticated()">
						    <svg xmlns="http://www.w3.org/2000/svg" width="27" height="27" viewBox="0 0 48 48" fill="currentColor">
						      <path d="M 23.277344 4.0175781 C 15.193866 4.3983176 9 11.343391 9 19.380859 L 9 26.648438 L 6.3496094 31.980469 A 1.50015 1.50015 0 0 0 6.3359375 32.009766 C 5.2696804 34.277268 6.9957076 37 9.5019531 37 L 18 37 C 18 40.295865 20.704135 43 24 43 C 27.295865 43 30 40.295865 30 37 L 38.496094 37 C 41.002339 37 42.730582 34.277829 41.664062 32.009766 A 1.50015 1.50015 0 0 0 41.650391 31.980469 L 39 26.648438 L 39 19 C 39 10.493798 31.863289 3.6133643 23.277344 4.0175781 z M 23.417969 7.0136719 C 30.338024 6.6878857 36 12.162202 36 19 L 36 27 A 1.50015 1.50015 0 0 0 36.15625 27.667969 L 38.949219 33.289062 C 39.128826 33.674017 38.921017 34 38.496094 34 L 9.5019531 34 C 9.077027 34 8.8709034 33.674574 9.0507812 33.289062 C 9.0507812 33.289062 9.0507812 33.287109 9.0507812 33.287109 L 11.84375 27.667969 A 1.50015 1.50015 0 0 0 12 27 L 12 19.380859 C 12 12.880328 16.979446 7.3169324 23.417969 7.0136719 z M 21 37 L 27 37 C 27 38.674135 25.674135 40 24 40 C 22.325865 40 21 38.674135 21 37 z"></path>
						    </svg>
						    <!--<span class="alarm-dot" id="alarmDot"></span> üî¥ ÏïåÎ¶º Ï†ê -->
						  </a>
						  <!-- ÏïåÎ¶º ÌåùÏóÖ -->
                          <div class="alarm-popup" id="alarm-popup-black">
                            <div class="alarmList" id="alarmList-black">
                                <!-- ÏïåÎûåÎì§Ïù¥ Ïó¨Í∏∞ Ï∂îÍ∞ÄÎê® -->
                                <div class="alarm-item notifyNewChatMessage"></div>
                                <div class="alarm-item alarm-radio-button">
                                    <div class="btn-group form-control" role="group" aria-label="Basic radio toggle button group">
                                        <button type="button" class="btn btn-secondary" id="showNewAlarms"
                                            style="--bs-btn-padding-y: .25rem; --bs-btn-padding-x: .5rem; --bs-btn-font-size: .75rem;">
                                            Ïïà ÏùΩÏùÄ ÏïåÎ¶ºÎßå ÌëúÏãú
                                        </button>
                                        <button type="button" class="btn btn-outline-secondary" id="showAllAlarms"
                                            style="--bs-btn-padding-y: .25rem; --bs-btn-padding-x: .5rem; --bs-btn-font-size: .75rem;">
                                            Î™®Îì† ÏïåÎ¶º ÌëúÏãú
                                        </button>
                                    </div>
                                </div>
                                <div class="alarmContents"></div>
                                <div class="alarm-loading" id="alarm-loading-black">Î°úÎî© Ï§ë...</div>
                            </div>
                          </div>
						</li>
						
					</ul>
                    </div>
                </div>
            </nav>
            
	        <nav class="navbar navbar-expand-sm bg-body-tertiary header-bottom">
	            <div class="container-fluid container-head">
	                <a class="navbar-brand" th:href="@{/}">
	                <img th:src="@{/images/logo6.PNG}" alt="ÎπåÎ¶¨Í≥†Î°úÍ≥†" width="150"></a>
	                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
	                    <span class="navbar-toggler-icon"></span>
	                </button>
	                <form th:action="@{/search}" method="get" class="search-box">
                        <label for="search-input" style="cursor: pointer; width: 100%;">
                            <input type="text" id="search-input" name="search" placeholder="ÏäàÌçºÏπ¥Î•º Îã®Îèà ÎßåÏõêÏóê?!" readonly onclick="this.form.submit()">
                        </label>
                        <button type="submit" class="headsearch-icon"></button>
                    </form>
	
	                
	                <div class="collapse navbar-collapse justify-content-end" id="navbarNav">
	                    <ul class="navbar-nav">
					    <!-- Í≥µÌÜµ Î©îÎâ¥ -->
					    <li class="nav-item"><a class="nav-link" th:href="@{/chat}">CHAT</a></li>
					    <li class="nav-item"><a class="nav-link" th:href="@{/jjam/shop}">JJAM</a></li>
					
					    <!-- Î°úÍ∑∏Ïù∏ ÏÉÅÌÉúÎ≥Ñ Î∂ÑÍ∏∞ -->
					    <th:block sec:authorize="isAnonymous()">
					        <li class="nav-item"><a class="nav-link" th:href="@{/member/signin}">LOGIN</a></li>
					        <li class="nav-item"><a class="nav-link" th:href="@{/member/signup}">JOIN</a></li>
					    </th:block>
					
					    <th:block sec:authorize="isAuthenticated()">
						  <li class="nav-item position-relative mypage-container">
						    <button class="nav-link btn btn-link mypage-btn">MY</button>
						    <div class="mypage-popup">
						      <a class="nav-link pop-nav-link" th:href="@{/mypage}">
						        <span class="emoji">ü•∞</span> ÎßàÏù¥ÌéòÏù¥ÏßÄ
						      </a>
						      <a class="nav-link pop-nav-link" th:href="@{/member/modify}">
						        <span class="emoji">üõ†Ô∏è</span> Ï†ïÎ≥¥ ÏàòÏ†ï
						      </a>
						      <a class="nav-link pop-nav-link" th:href="@{/logout}">
						        <span class="emoji">üîì</span> Î°úÍ∑∏ÏïÑÏõÉ
						      </a>
						    </div>
						  </li>
						</th:block>

					
					    <!-- Ìï≠ÏÉÅ Ïò§Î•∏Ï™ΩÏóê Í≥†Ï†ïÎê† ÏïåÎûå Î©îÎâ¥ -->
					  <li class="nav-item position-relative alarm-container">
  						  <a class="nav-link alarm-btn" href="javascript:void(0)" sec:authorize="isAuthenticated()">
						    <svg xmlns="http://www.w3.org/2000/svg" width="27" height="27" viewBox="0 0 48 48" fill="currentColor">
						      <path d="M 23.277344 4.0175781 C 15.193866 4.3983176 9 11.343391 9 19.380859 L 9 26.648438 L 6.3496094 31.980469 A 1.50015 1.50015 0 0 0 6.3359375 32.009766 C 5.2696804 34.277268 6.9957076 37 9.5019531 37 L 18 37 C 18 40.295865 20.704135 43 24 43 C 27.295865 43 30 40.295865 30 37 L 38.496094 37 C 41.002339 37 42.730582 34.277829 41.664062 32.009766 A 1.50015 1.50015 0 0 0 41.650391 31.980469 L 39 26.648438 L 39 19 C 39 10.493798 31.863289 3.6133643 23.277344 4.0175781 z M 23.417969 7.0136719 C 30.338024 6.6878857 36 12.162202 36 19 L 36 27 A 1.50015 1.50015 0 0 0 36.15625 27.667969 L 38.949219 33.289062 C 39.128826 33.674017 38.921017 34 38.496094 34 L 9.5019531 34 C 9.077027 34 8.8709034 33.674574 9.0507812 33.289062 C 9.0507812 33.289062 9.0507812 33.287109 9.0507812 33.287109 L 11.84375 27.667969 A 1.50015 1.50015 0 0 0 12 27 L 12 19.380859 C 12 12.880328 16.979446 7.3169324 23.417969 7.0136719 z M 21 37 L 27 37 C 27 38.674135 25.674135 40 24 40 C 22.325865 40 21 38.674135 21 37 z"></path>
						    </svg>
						    <!--<span class="alarm-dot" id="alarmDot"></span> üî¥ ÏïåÎ¶º Ï†ê -->
						  </a>
						  <!-- ÏïåÎ¶º ÌåùÏóÖ -->
                          <div class="alarm-popup">
                            <div class="alarmList" id="alarmList-white">
                                <!-- ÏïåÎûåÎì§Ïù¥ Ïó¨Í∏∞ Ï∂îÍ∞ÄÎê® -->
                                <div class="alarm-item notifyNewChatMessage"></div>
                                <div class="alarm-item alarm-radio-button">
                                    <div class="btn-group form-control" role="group" aria-label="Basic radio toggle button group">
                                        <button type="button" class="btn btn-secondary" id="showNewAlarms"
                                            style="--bs-btn-padding-y: .25rem; --bs-btn-padding-x: .5rem; --bs-btn-font-size: .75rem;">
                                            Ïïà ÏùΩÏùÄ ÏïåÎ¶ºÎßå ÌëúÏãú
                                        </button>
                                        <button type="button" class="btn btn-outline-secondary" id="showAllAlarms"
                                            style="--bs-btn-padding-y: .25rem; --bs-btn-padding-x: .5rem; --bs-btn-font-size: .75rem;">
                                            Î™®Îì† ÏïåÎ¶º ÌëúÏãú
                                        </button>
                                    </div>
                                </div>
                                <div class="alarmContents"></div>
                                <div class="alarm-loading" id="alarm-loading-white">Î°úÎî© Ï§ë...</div>
                            </div>
                          </div>
						</li>
					</ul>
                </div>
	            </div>
	        </nav>
    	</header>
	</th:block>
        
        <th:block th:fragment="pagination">
         <nav aria-label="Page navigation">
            <ul class="pagination justify-content-center">
               <li class="page-item"
                  th:classappend="${!page.hasPrevious} ? 'disabled'">
                  <!-- Ïù¥Ï†Ñ ÌéòÏù¥ÏßÄÍ∞Ä ÏóÜÏùÑ Îïå 'disabled' ÌÅ¥ÎûòÏä§ ÏÜçÏÑ±ÏùÑ Ï∂îÍ∞Ä -->
                  
                  <a class="page-link" th:href="@{${baseUrl}(p=${page.number - 1}, category=${param.category}, keyword=${param.keyword})}">Ïù¥Ï†Ñ</a>
                  <!-- (ÌòÑÏû¨ ÌéòÏù¥ÏßÄ Î≤àÌò∏) -1 ÌéòÏù¥ÏßÄÎ°ú Ïù¥Îèô-->
                  
               </li>
               <li class="page-item" 
                  th:each="pageNo : ${#numbers.sequence(0, page.totalPages - 1, 1)}"
                  th:if="${pageNo >= page.number - 3 && pageNo < page.number + 3}"
                  th:classappend="${pageNo == page.number} ? 'active'">
                  <!-- PageNo Í∞íÏù¥ ÌòÑÏû¨ ÌéòÏù¥ÏßÄ Î≤àÌò∏ÏôÄ Í∞ôÏúºÎ©¥ 'active ÌÅ¥ÎûòÏä§ ÏÜçÏÑ± Ï∂îÍ∞Ä -->
                      <a class="page-link"
                          th:href="@{${baseUrl}(p=${page.number + 1}, category=${param.category}, keyword=${param.keyword})}"
                          th:text="${pageNo +1 }"></a>
                  </li>
               <li class="page-item"
                  th:classappend="${!page.hasNext} ? 'disabled'">
                  <!--  Îã§Ïùå ÌéòÏù¥ÏßÄÍ∞Ä ÏóÜÏùÑ Îïå 'disabled' ÌÅ¥ÎûôÏä§ ÏÜçÏÑ±ÏùÑ Ï∂îÍ∞Ä -->
                  
                  <a class="page-link" th:href="@{${baseUrl}(p=${page.number + 1}, category=${param.category}, keyword=${param.keyword})}">Îã§Ïùå</a>
                  <!-- (ÌòÑÏû¨ ÌéòÏù¥ÏßÄ Î≤àÌò∏) +1 ÌéòÏù¥ÏßÄÎ°ú Ïù¥Îèô-->
                  </li>
            </ul>
         </nav>
      </th:block>
      
      <footer th:fragment="pageFooter">
          <!-- ÏïåÎûå ÌÜ†Ïä§Ìä∏Ïö© ÏÑπÏÖò -->
          <section id="toaster"></section>
			
			<!-- ÌîåÎ°úÌåÖ + Î≤ÑÌäº -->
		<div class="floating-plus-button" id="plusToggleButton">
		  <svg xmlns="http://www.w3.org/2000/svg" id="plusIcon" width="32" height="32" fill="white" viewBox="0 0 24 24">
		    <path d="M12 5v14m-7-7h14" stroke="white" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"/>
		  </svg>
		  <svg xmlns="http://www.w3.org/2000/svg" id="closeIcon" width="32" height="32" fill="white" viewBox="0 0 24 24" style="display: none">
		    <path d="M6 6l12 12M6 18L18 6" stroke="white" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"/>
		  </svg>
		</div>
		
		<!-- ÌîåÎ°úÌåÖ ÌåùÏóÖ Î©îÎâ¥ -->
		<div class="floating-popup" id="plusPopup">
		  <a href="/post/category" class="floating-item">
		    <span class="float-emoji">üöÄ</span> ÏÉÅÌíàÏò¨Î¶¨Í∏∞
		  </a>
		  <a href="/search" class="floating-item">
		    <span class="float-emoji">üîç</span> Í≤ÄÏÉâ
		  </a>
		</div>

          <!-- AI Ï±óÎ¥á Î≤ÑÌäº -->
		 
    <div class="ai-chatbot-button" onclick="toggleChatbot()">
    	<svg width="50" height="50" viewBox="0 0 50 50" fill="none" xmlns="http://www.w3.org/2000/svg">
		  <!-- ‚úÖ Î°úÎ¥á Î≥∏Ï≤¥ (ÌÅ¨Í∏∞ ÌôïÎåÄ) -->
		  <rect x="9" y="15" width="32" height="22" rx="7" stroke="white" stroke-width="3"/>
		  
		  <!-- ‚úÖ Îàà (ÌÅ¨Í∏∞ ÌôïÎåÄ) -->
		  <circle cx="17" cy="24" r="3" fill="white"/>
		  <circle cx="33" cy="24" r="3" fill="white"/>
		  
		  <!-- ‚úÖ ÏûÖ (ÌÅ¨Í∏∞ ÌôïÎåÄ) -->
		  <line x1="17" y1="31" x2="33" y2="31" stroke="white" stroke-width="2" stroke-linecap="round"/>
		  
		  <!-- ‚úÖ ÏïàÌÖåÎÇò (ÌÅ¨Í∏∞ Ï°∞Ï†ï) -->
		  <line x1="25" y1="6" x2="25" y2="15" stroke="white" stroke-width="3" stroke-linecap="round"/>
		</svg>
	</div>
			

		  
		  <!-- AI Ï±óÎ¥á Ï∞Ω -->
		  <div id="chatbotWindow" class="chatbot-container">
		    <div class="chatbot-header">
		      <span id="authenticatedUser"> 
                <span sec:authorize="isAuthenticated()" th:text="${#authentication.name}">User</span>
                <span sec:authorize="isAnonymous()">Guest</span>
              </span>
              Îãò ÏïàÎÖïÌïòÏÑ∏Ïöî!
		      <button onclick="toggleChatbot()">X</button>
		    </div>
	        <div class="chatbot-messages" id="chatbotMessages">
	            <p>ü§ñ Ïù∏Í≥µÏßÄÎä• ÎπåÎ¶¨Ï±óÏûÖÎãàÎã§. <br> Î¨¥ÏóáÏùÑ ÎèÑÏôÄÎìúÎ¶¥ÍπåÏöî?</p>
	        </div>
	         
		        <!-- FAQ Î≤ÑÌäºÎì§: Ìï≠ÏÉÅ Î≥¥Ïù¥Îäî Í≥†Ï†ï ÏòÅÏó≠ -->
			<div class="chatbot-faq-buttons" id="faqButtons"></div>
	        <!-- ‚úÖ Î©îÏãúÏßÄ ÏûÖÎ†•Ï∞Ω -->
	        <div class="chatbot-input-container">
			  <input type="text" id="chatbotInput" class="chatbot-input" placeholder="Î©îÏãúÏßÄÎ•º ÏûÖÎ†•ÌïòÏÑ∏Ïöî...">
			  <button class="chatbot-send-btn" onclick="sendChatbotMessage()">Ï†ÑÏÜ°</button>
			</div>

		  </div>
		</footer>
		
			<th:block th:fragment="commonLayout">
			    <th:block th:replace="layout/fragments :: pageHeader"></th:block>
			    <th:block th:replace="layout/fragments :: pageFooter"></th:block>
			</th:block>
			
		
       <th:block th:fragment="bootstrapJS">
	    	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
	        integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
	        crossorigin="anonymous"></script>
            <!-- ÏïåÎûå ÌÖåÏä§Ìä∏Ïö© sockJS, stomp, ÏïåÎûå JS -->
            <script src="https://cdn.jsdelivr.net/npm/sockjs-client@1.6.1/dist/sockjs.min.js"></script>
            <script src="https://cdn.jsdelivr.net/npm/@stomp/stompjs@7.1.0/bundles/stomp.umd.min.js"></script>
            <script th:src="@{/js/alarm.js}"></script>            
            <script th:src="@{/js/mypagepop.js}"></script>
	        <script th:src="@{/js/chatbot.js}"></script>
	        
	        <link rel="stylesheet" th:href="@{/css/global.css}">
	        <link rel="stylesheet" th:href="@{/css/mypage-pop.css}">
		</th:block>		
    </body>
</html>